{{ layout "./layouts/guest_layout.html" }}

{{ block "title" }}ThisPage - Documentation{{ endblock }}

{{ block "main" }}
<div class="flex flex-col lg:flex-row gap-8 -mx-6 lg:-mx-0">
    <!-- Sidebar Navigation -->
    <aside class="hidden lg:block lg:w-64 flex-shrink-0">
        <div class="sticky top-8">
            <div class="mb-6">
                <a href="/" class="text-sm text-neutral-500 hover:text-white transition-colors flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                    </svg>
                    Back to Portfolio
                </a>
            </div>
            <h2 class="text-xl font-bold text-white mb-6 bg-gradient-to-r from-white to-neutral-400 bg-clip-text text-transparent">ThisPage</h2>

            <nav class="space-y-6">
                <div>
                    <h3 class="text-xs uppercase tracking-wider text-neutral-500 font-semibold mb-3">Getting Started</h3>
                    <div class="space-y-2">
                        <a href="#introduction" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Introduction</a>
                        <a href="#installation" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Installation</a>
                        <a href="#project-structure" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Project Structure</a>
                    </div>
                </div>
                <div>
                    <h3 class="text-xs uppercase tracking-wider text-neutral-500 font-semibold mb-3">CLI Reference</h3>
                    <div class="space-y-2">
                        <a href="#cli-commands" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Commands</a>
                    </div>
                </div>
                <div>
                    <h3 class="text-xs uppercase tracking-wider text-neutral-500 font-semibold mb-3">Templating</h3>
                    <div class="space-y-2">
                        <a href="#layouts" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Layouts & Blocks</a>
                        <a href="#components" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Components</a>
                        <a href="#tailwind" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Tailwind CSS</a>
                    </div>
                </div>
                <div>
                    <h3 class="text-xs uppercase tracking-wider text-neutral-500 font-semibold mb-3">Admin Panel</h3>
                    <div class="space-y-2">
                        <a href="#admin-features" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Features</a>
                        <a href="#security" class="block text-neutral-400 hover:text-green-400 hover:pl-2 transition-all text-sm">Security</a>
                    </div>
                </div>
            </nav>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 min-w-0 px-6 lg:px-0">
        <!-- Mobile Header -->
        <div class="lg:hidden mb-8">
            <a href="/" class="text-sm text-neutral-500 hover:text-white transition-colors flex items-center gap-2 mb-4">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Back to Portfolio
            </a>
        </div>

        <!-- Introduction -->
        <section id="introduction" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">Introduction</h2>
            <p class="text-neutral-300 mb-6"><strong class="text-white">ThisPage</strong> is a robust static site generator designed for speed and simplicity. It combines a custom HTML-first templating engine with automatic Tailwind CSS integration and a built-in administrative interface for content management.</p>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
                <div class="bg-neutral-900 border border-neutral-800 rounded-lg p-5">
                    <h4 class="text-white font-semibold mb-2 flex items-center gap-2">
                        <span class="text-green-400">‚ö°</span> Live Reloading
                    </h4>
                    <p class="text-neutral-400 text-sm">Changes to templates, components, or static files trigger an immediate rebuild.</p>
                </div>
                <div class="bg-neutral-900 border border-neutral-800 rounded-lg p-5">
                    <h4 class="text-white font-semibold mb-2 flex items-center gap-2">
                        <span class="text-green-400">üé®</span> Tailwind Native
                    </h4>
                    <p class="text-neutral-400 text-sm">Automatically downloads and configures the Tailwind v4 binary for your architecture.</p>
                </div>
                <div class="bg-neutral-900 border border-neutral-800 rounded-lg p-5">
                    <h4 class="text-white font-semibold mb-2 flex items-center gap-2">
                        <span class="text-green-400">üõ°Ô∏è</span> Admin Interface
                    </h4>
                    <p class="text-neutral-400 text-sm">Built-in file editor, uploader, and zip deployment system secured by session tokens.</p>
                </div>
            </div>
        </section>

        <!-- Installation -->
        <section id="installation" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">Installation & Setup</h2>
            <p class="text-neutral-300 mb-4">Install the <code class="bg-neutral-800 text-green-400 px-2 py-1 rounded text-sm font-mono">thispage</code> CLI tool to get started.</p>

            <pre class="bg-neutral-900 border border-neutral-800 rounded-lg p-4 overflow-x-auto mb-4"><code class="text-sm font-mono"><span class="text-neutral-500"># Initialize a new project</span>
<span class="text-green-400">thispage</span> init my-website admin securepassword123

<span class="text-neutral-500"># Enter the directory</span>
<span class="text-green-400">cd</span> my-website

<span class="text-neutral-500"># Start the development server</span>
<span class="text-green-400">thispage</span> serve</code></pre>

            <p class="text-neutral-400 text-sm">The server will start on port <strong class="text-white">8080</strong> by default. Tailwind CSS will automatically download and start watching your <code class="bg-neutral-800 text-neutral-300 px-1.5 py-0.5 rounded text-xs font-mono">static/input.css</code> file.</p>
        </section>

        <!-- Project Structure -->
        <section id="project-structure" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">Project Structure</h2>
            <p class="text-neutral-300 mb-4">When you initialize a project, the following directory structure is created:</p>

            <pre class="bg-neutral-900 border border-neutral-800 rounded-lg p-4 overflow-x-auto"><code class="text-sm font-mono text-neutral-300">my-website/
‚îú‚îÄ‚îÄ .thispage/         <span class="text-neutral-500"># Credentials and seeds (gitignored)</span>
‚îú‚îÄ‚îÄ components/        <span class="text-neutral-500"># Reusable HTML snippets (nav, footer)</span>
‚îú‚îÄ‚îÄ layouts/           <span class="text-neutral-500"># Master page wrappers</span>
‚îú‚îÄ‚îÄ live/              <span class="text-neutral-500"># The compiled static site (do not edit directly)</span>
‚îú‚îÄ‚îÄ static/            <span class="text-neutral-500"># CSS, JS, Images</span>
‚îÇ   ‚îî‚îÄ‚îÄ input.css      <span class="text-neutral-500"># Tailwind entry point</span>
‚îú‚îÄ‚îÄ templates/         <span class="text-neutral-500"># Your actual pages</span>
‚îú‚îÄ‚îÄ data.db            <span class="text-neutral-500"># SQLite database for sessions/rate limiting</span>
‚îî‚îÄ‚îÄ .env               <span class="text-neutral-500"># Environment variables</span></code></pre>
        </section>

        <!-- CLI Commands -->
        <section id="cli-commands" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">CLI Commands</h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-neutral-900">
                            <th class="text-left p-4 text-white font-semibold border-b border-neutral-800">Command</th>
                            <th class="text-left p-4 text-white font-semibold border-b border-neutral-800">Arguments</th>
                            <th class="text-left p-4 text-white font-semibold border-b border-neutral-800">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-sm">
                        <tr class="border-b border-neutral-800">
                            <td class="p-4"><code class="text-green-400 font-mono">init</code></td>
                            <td class="p-4 text-neutral-400"><code class="font-mono">&lt;name&gt; &lt;user&gt; &lt;pass&gt;</code></td>
                            <td class="p-4 text-neutral-400">Creates a new project with admin credentials. Use <code class="bg-neutral-800 px-1 rounded">--force</code> to overwrite.</td>
                        </tr>
                        <tr class="border-b border-neutral-800">
                            <td class="p-4"><code class="text-green-400 font-mono">serve</code></td>
                            <td class="p-4 text-neutral-400"><code class="font-mono">[path] [port]</code></td>
                            <td class="p-4 text-neutral-400">Builds the site, starts the file watcher, and runs the HTTP server.</td>
                        </tr>
                        <tr class="border-b border-neutral-800">
                            <td class="p-4"><code class="text-green-400 font-mono">build</code></td>
                            <td class="p-4 text-neutral-400"><code class="font-mono">&lt;path&gt;</code></td>
                            <td class="p-4 text-neutral-400">Compiles the site once without starting a server.</td>
                        </tr>
                        <tr class="border-b border-neutral-800">
                            <td class="p-4"><code class="text-green-400 font-mono">watch</code></td>
                            <td class="p-4 text-neutral-400"><code class="font-mono">&lt;path&gt;</code></td>
                            <td class="p-4 text-neutral-400">Watches for file changes and rebuilds, but does not serve HTTP.</td>
                        </tr>
                        <tr class="border-b border-neutral-800">
                            <td class="p-4"><code class="text-green-400 font-mono">mount</code></td>
                            <td class="p-4 text-neutral-400"><code class="font-mono">&lt;path&gt; &lt;user&gt; &lt;pass&gt;</code></td>
                            <td class="p-4 text-neutral-400">Generates new credentials/seed for an existing project (useful after git clone).</td>
                        </tr>
                        <tr>
                            <td class="p-4"><code class="text-green-400 font-mono">credentials</code></td>
                            <td class="p-4 text-neutral-400"><code class="font-mono">&lt;path&gt;</code></td>
                            <td class="p-4 text-neutral-400">Displays the current encrypted admin credentials and session key.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Layouts -->
        <section id="layouts" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">Templating Engine</h2>
            <p class="text-neutral-300 mb-6">ThisPage uses a custom tokenizer and compiler. It does not use standard Go templates, but rather a custom syntax focused on composition.</p>

            <h3 class="text-xl font-semibold text-white mb-4">Layouts & Blocks</h3>
            <p class="text-neutral-400 mb-4">Define a master layout using slots or blocks, then inherit it in your templates.</p>

            <p class="text-sm text-neutral-500 mb-2 font-medium">layouts/guest_layout.html</p>
            <pre class="bg-neutral-900 border border-neutral-800 rounded-lg p-4 overflow-x-auto mb-6"><code class="text-sm font-mono"><span class="text-blue-400">&lt;!DOCTYPE html&gt;</span>
&lt;html&gt;
&lt;body&gt;
    <span class="text-purple-400">{{</span> slot "main" <span class="text-purple-400">}}</span>
&lt;/body&gt;
&lt;/html&gt;</code></pre>

            <p class="text-sm text-neutral-500 mb-2 font-medium">templates/index.html</p>
            <pre class="bg-neutral-900 border border-neutral-800 rounded-lg p-4 overflow-x-auto"><code class="text-sm font-mono"><span class="text-purple-400">{{</span> layout "./layouts/guest_layout.html" <span class="text-purple-400">}}</span>

    <span class="text-purple-400">{{</span> block "main" <span class="text-purple-400">}}</span>
        &lt;h1&gt;Welcome to my site&lt;/h1&gt;
        &lt;p&gt;This content is injected into the slot.&lt;/p&gt;
    <span class="text-purple-400">{{</span> endblock <span class="text-purple-400">}}</span>

<span class="text-purple-400">{{</span> endlayout <span class="text-purple-400">}}</span></code></pre>
        </section>

        <!-- Components -->
        <section id="components" class="mb-16 scroll-mt-8">
            <h3 class="text-xl font-semibold text-white mb-4">Components & Includes</h3>
            <p class="text-neutral-400 mb-4">You can reuse HTML snippets using the include directive. You can also pass properties to components.</p>

            <p class="text-sm text-neutral-500 mb-2 font-medium">templates/index.html</p>
            <pre class="bg-neutral-900 border border-neutral-800 rounded-lg p-4 overflow-x-auto mb-6"><code class="text-sm font-mono"><span class="text-purple-400">{{</span> include "./components/navbar.html" title="Home Page" <span class="text-purple-400">}}</span></code></pre>

            <p class="text-sm text-neutral-500 mb-2 font-medium">components/navbar.html</p>
            <pre class="bg-neutral-900 border border-neutral-800 rounded-lg p-4 overflow-x-auto"><code class="text-sm font-mono">&lt;nav&gt;
    &lt;div&gt;<span class="text-purple-400">{{</span> prop "title" <span class="text-purple-400">}}</span>&lt;/div&gt;
&lt;/nav&gt;</code></pre>
        </section>

        <!-- Tailwind -->
        <section id="tailwind" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">Tailwind CSS Integration</h2>
            <p class="text-neutral-300 mb-4">ThisPage has native support for Tailwind CSS. You do not need Node.js installed.</p>
            <p class="text-neutral-400 mb-4">When you run <code class="bg-neutral-800 text-green-400 px-2 py-1 rounded text-sm font-mono">thispage serve</code>, the system:</p>

            <ol class="list-decimal list-inside space-y-2 text-neutral-400 mb-4">
                <li>Checks for a valid Tailwind binary in <code class="bg-neutral-800 text-neutral-300 px-1.5 py-0.5 rounded text-xs font-mono">~/.thispage/bin</code>.</li>
                <li>Downloads the correct binary for your OS/Arch (v4.1.18) if missing.</li>
                <li>Runs the binary in watch mode, compiling <code class="bg-neutral-800 text-neutral-300 px-1.5 py-0.5 rounded text-xs font-mono">static/input.css</code> to <code class="bg-neutral-800 text-neutral-300 px-1.5 py-0.5 rounded text-xs font-mono">static/output.css</code>.</li>
            </ol>

            <p class="text-neutral-400">Simply use Tailwind utility classes in your HTML files, and they will work immediately.</p>
        </section>

        <!-- Admin Features -->
        <section id="admin-features" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">Admin Interface</h2>
            <p class="text-neutral-300 mb-6">Access the admin panel by navigating to <code class="bg-neutral-800 text-green-400 px-2 py-1 rounded text-sm font-mono">/login</code> or <code class="bg-neutral-800 text-green-400 px-2 py-1 rounded text-sm font-mono">/admin</code>. The admin system allows you to manage the site directly from the browser.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-neutral-900 border border-neutral-800 rounded-lg p-5">
                    <h4 class="text-white font-semibold mb-2 flex items-center gap-2">
                        <span class="text-green-400">üìù</span> Live Editing
                    </h4>
                    <p class="text-neutral-400 text-sm">When logged in as admin, an "Edit" button appears on live pages, linking directly to the source file in the admin editor.</p>
                </div>
                <div class="bg-neutral-900 border border-neutral-800 rounded-lg p-5">
                    <h4 class="text-white font-semibold mb-2 flex items-center gap-2">
                        <span class="text-green-400">üìÅ</span> File Manager
                    </h4>
                    <p class="text-neutral-400 text-sm">Create, rename, delete, and upload files. Navigate through templates, components, and static assets.</p>
                </div>
                <div class="bg-neutral-900 border border-neutral-800 rounded-lg p-5">
                    <h4 class="text-white font-semibold mb-2 flex items-center gap-2">
                        <span class="text-green-400">üöÄ</span> Zip Deployment
                    </h4>
                    <p class="text-neutral-400 text-sm">Upload a .zip file containing your project structure to instantly deploy updates. Includes logic to prevent "Zip Slip" attacks.</p>
                </div>
                <div class="bg-neutral-900 border border-neutral-800 rounded-lg p-5">
                    <h4 class="text-white font-semibold mb-2 flex items-center gap-2">
                        <span class="text-green-400">üì¶</span> Export
                    </h4>
                    <p class="text-neutral-400 text-sm">Download a full backup of your project (templates, components, static files) as a .zip file.</p>
                </div>
            </div>
        </section>

        <!-- Security -->
        <section id="security" class="mb-16 scroll-mt-8">
            <h2 class="text-3xl font-bold text-white mb-6 pb-4 border-b border-neutral-800">Security & Auth</h2>
            <p class="text-neutral-300 mb-4">Security is built into the core:</p>

            <ul class="space-y-3 text-neutral-400">
                <li class="flex items-start gap-3">
                    <span class="text-green-400 mt-1">‚Ä¢</span>
                    <span><strong class="text-white">Encryption:</strong> Credentials are stored using AES-GCM encryption with a project-specific seed.</span>
                </li>
                <li class="flex items-start gap-3">
                    <span class="text-green-400 mt-1">‚Ä¢</span>
                    <span><strong class="text-white">Rate Limiting:</strong> Login attempts are tracked by IP. 5 failed attempts trigger a temporary block. Excessive failures trigger a permanent blacklist.</span>
                </li>
                <li class="flex items-start gap-3">
                    <span class="text-green-400 mt-1">‚Ä¢</span>
                    <span><strong class="text-white">Session Management:</strong> Secure, HTTP-only cookies are used for session management.</span>
                </li>
                <li class="flex items-start gap-3">
                    <span class="text-green-400 mt-1">‚Ä¢</span>
                    <span><strong class="text-white">Path Traversal Protection:</strong> The file system router and admin endpoints strictly validate paths to ensure they stay within the project root.</span>
                </li>
            </ul>
        </section>
    </main>
</div>
{{ endblock }}
{{ endlayout }}
